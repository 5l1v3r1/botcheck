# Making a call to the Botometer API from R

Botometer [checks the activity of a Twitter account and gives it a score based on how likely the account is to be a bot. Higher scores are more bot-like.](https://botometer.iuni.iu.edu/#!/)

Using the [Botometer API](https://market.mashape.com/OSoMe/botometer) is pretty simple. You POST a .json file that [looks like the example request payload here](https://market.mashape.com/OSoMe/botometer) and then receive the response. [Read the overview](https://market.mashape.com/OSoMe/botometer/overview) for more information.

The API documentation provides example API requests in a variety of formats, but there aren't any examples using R. This very simple script is a template you can use for making calls to Botometer in R.

You must first [get your own API key](https://market.mashape.com/OSoMe/botometer). Then load libraries:

```{r, eval=FALSE}
library(httr)
library(xml2) 
library(RJSONIO)
```

You'll also need to create and register a [Twitter app](https://apps.twitter.com/). Save your keys by replacing the "xxxx" placeholders.

```{r, eval=FALSE}
consumer_key = "xxxxxxxxxxxxxxx"
consumer_secret = "xxxxxxxxxxxxxxx"
access_token = 	"xxxxxxxxxxxxxxx"
access_secret = 	"xxxxxxxxxxxxxxx"
```

Now retreive the necessary info from Twitter. In the API calls below, replace "joeydm" (my Twitter handle) with someone else's.

```{r, eval=F}
# Authorizations
myapp = oauth_app("twitter", key=consumer_key, secret=consumer_secret)
sig = sign_oauth1.0(myapp, token=access_token, token_secret=access_secret)

# API call to get "user" object
userdata=GET("https://api.twitter.com/1.1/users/show.json?screen_name=joeydm&count=200", sig)

# API call to get "tweets" object
tweets = GET("https://api.twitter.com/1.1/statuses/user_timeline.json?screen_name=joeydm&count=200", sig)

# API call to get "mentions" object
mentions = GET("https://api.twitter.com/1.1/search/tweets.json?q=%40joeydm&count=200", sig)

```

Finally, you have to construct the JSON payload that we'll send to Botometer.

```{r, eval=F}
# Put everything in a list
body = list(
	timeline = content(tweets, type="application/json"),
	mentions = content(mentions, type="application/json"),
	user = content(userdata, type="application/json")
)

# Convert to JSON
body_json = RJSONIO::toJSON(body, auto_unbox=TRUE, pretty = T)
```

Make the API call to Botometer. Replace "xxxxxxxxxx" with your own Botometer key.

```{r, eval=F}
result <- POST("https://osome-botometer.p.mashape.com/2/check_account",
               verbose(),
               encode="json",
               add_headers(`X-Mashape-Key`="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"),
               body= body_json)
```

And View the result

```{r, eval=F}
content(result)
```

## Future plans

This is just a rough-and-ready example of making a successful API call to Botometer. I'll soon wrap this up into a simple function that you can call, e.g., ```botcheck(twitter_user)```

Feel free to [DM me](https://twitter.com/joeydm) with questions. 



